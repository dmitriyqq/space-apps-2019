(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{18:function(e,t,n){e.exports=n.p+"static/media/logo.25bf045c.svg"},20:function(e,t,n){e.exports=n.p+"static/media/Gorod.2c8efb48.svg"},21:function(e,t,n){e.exports=n(31)},26:function(e,t,n){},27:function(e,t,n){},31:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),i=n(17),o=n.n(i),s=(n(26),n(6)),c=n(9),l=n(13),u=n(11),h=n(15),p=(n(27),n(7)),m=n.n(p),d=n(10),f=n(34),v=n(35),g=n(33),b=n(1),y=n.n(b),w=n(18),k=n.n(w),j=(new y.a.Icon({shadowUrl:void 0,className:"goodicon"}),new y.a.Icon({shadowUrl:void 0,className:"badicon"}),new y.a.Icon({shadowUrl:void 0,iconUrl:k.a}),function(e){function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={lat:51.505,lng:-.09,zoom:4,cities:[]},n.shouldComponentUpdate=function(e,t){return n.props.lvl==e.lvl||(n.updateCities(),!0)},n.map=void 0,n.handleClick=function(e){var t=null,a=.1;console.log(e);var r=e.latlng,i=r.lat,o=r.lng,s=!0,c=!1,l=void 0;try{for(var u,h=n.state.cities[Symbol.iterator]();!(s=(u=h.next()).done);s=!0){var p=u.value,m=p.lat-i,d=p.lng-o,f=m*m+d*d;f<a&&(t=p,a=f)}}catch(v){c=!0,l=v}finally{try{s||null==h.return||h.return()}finally{if(c)throw l}}console.log(a),null!=t&&n.props.onClick(t)},n.handleViewportChange=function(e){n.setState({zoom:Math.max(10,e.zoom)}),n.updateCities()},n.updateCities=Object(d.a)(m.a.mark((function e(){var t,a,r;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n.map||!n.map.leafletElement){e.next=13;break}return e.prev=1,t=n.map.leafletElement.getBounds(),e.next=5,n.props.dataService.getCitiesLevel(n.props.lvl,t._southWest.lat,t._southWest.lng,t._northEast.lat,t._northEast.lng);case 5:a=e.sent,r=a.cities,n.setState((function(){return{cities:r}})),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(1),console.error(e.t0);case 13:case"end":return e.stop()}}),e,null,[[1,10]])}))),n}return Object(h.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=Object(d.a)(m.a.mark((function e(){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.updateCities();case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=(Math.max(10,this.state.zoom),[this.state.lat,this.state.lng]);return r.a.createElement(f.a,{onClick:this.handleClick,ref:function(t){e.map=t},center:t,zoom:7,onViewportChange:this.handleViewportChange},r.a.createElement(v.a,{attribution:'&copy <a href="http://osm.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),this.state.cities.filter((function(e){return e.population>1e3})).map((function(e,t){return r.a.createElement(g.a,{icon:new y.a.Icon.Default({shadowUrl:void 0,className:e.destroyed?"bad":"good",iconUrl:void 0}),key:t,position:[e.lat,e.lng]})})))}}]),t}(a.Component)),x=function e(){Object(s.a)(this,e),this.years=[]},E=function e(){Object(s.a)(this,e),this.cities=[]},C=function(){function e(){Object(s.a)(this,e),this.base="http://127.0.0.1:5000"}return Object(c.a)(e,[{key:"getYears",value:function(){var e=Object(d.a)(m.a.mark((function e(){var t,n;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("".concat(this.base,"/years"));case 3:return t=e.sent,e.next=6,t.json();case 6:return n=e.sent,e.abrupt("return",n);case 10:return e.prev=10,e.t0=e.catch(0),console.error(e.t0),e.abrupt("return",new x);case 14:case"end":return e.stop()}}),e,this,[[0,10]])})));return function(){return e.apply(this,arguments)}}()},{key:"getCitiesLevel",value:function(){var e=Object(d.a)(m.a.mark((function e(t,n,a,r,i){var o,s;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("".concat(this.base,"/cities_below_level"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({level:t,swlat:n,swlng:a,nelat:r,nelng:i})});case 3:return o=e.sent,e.next=6,o.json();case 6:return s=e.sent,e.abrupt("return",s);case 10:return e.prev=10,e.t0=e.catch(0),console.error(e.t0),e.abrupt("return",new E);case 14:case"end":return e.stop()}}),e,this,[[0,10]])})));return function(t,n,a,r,i){return e.apply(this,arguments)}}()}]),e}(),O=n(20),N=n.n(O),S=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).handleClick=function(e){n.setState((function(){return{city:e}}))},n.myfunc=function(){var e=Number($(".irs-single")[0].innerText);n.setState({lvl:e})},n.state={lvl:0,city:null},n}return Object(h.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){$(".js-range-slider-2").ionRangeSlider({skin:"big",min:0,max:100,from:0,step:1,grid:!0,grid_num:10,grid_snap:!1})}},{key:"componentDidUpdate",value:function(){$(".js-range-slider-2").ionRangeSlider({skin:"big",min:0,max:100,from:0,step:1,grid:!0,grid_num:10,grid_snap:!1})}},{key:"render",value:function(){var e=null;return null!=this.state.city&&(e=r.a.createElement("div",{className:"smallStakan"},r.a.createElement("label",{className:"lab"},r.a.createElement("div",{className:"fil",id:"fill",style:{height:"".concat(Math.min(100-(Math.max(this.state.city.elevation,0)-this.state.lvl)/Math.max(this.state.city.elevation,1)*100,100),"%")}})),r.a.createElement("h1",null,this.state.city.name),r.a.createElement("h2",null,this.state.city.population," \u0447\u0435\u043b."),r.a.createElement("h2",null,this.state.city.elevation," \u043c"),r.a.createElement("img",{src:N.a,className:"gorod"}))),r.a.createElement("div",{className:"cont"},r.a.createElement("div",{className:"stakan"},e),r.a.createElement("div",{className:"map"},r.a.createElement(j,{onClick:this.handleClick,dataService:new C,lvl:this.state.lvl})),r.a.createElement("div",{className:"polzynok",onClick:this.myfunc},r.a.createElement("input",{type:"number",className:"js-range-slider-2",name:"my_range"})))}}]),t}(r.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(S,null),document.getElementById("root")),y.a.Icon.Default.imagePath="//cdnjs.cloudflare.com/ajax/libs/leaflet/1.3.4/images/","serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[21,1,2]]]);
//# sourceMappingURL=main.ef7023c6.chunk.js.map