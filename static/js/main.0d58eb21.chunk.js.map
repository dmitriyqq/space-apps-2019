{"version":3,"sources":["static/Gorod.svg","pages/Map.tsx","interfaces/IDataService.ts","services/DataService.ts","App.tsx","serviceWorker.ts","index.tsx"],"names":["module","exports","LeafletMap","state","zoom","map","handleClick","e","n","min","console","log","latlng","lat","lng","props","cities","city","dx","dy","v","onClick","handleViewportChange","viewport","setState","Math","max","updateCities","a","bounds","leafletElement","getBounds","needMapUpdate","_southWest","_northEast","error","this","Map","ref","center","onViewportChange","TileLayer","attribution","url","i","Marker","icon","Leaflet","Icon","Default","shadowUrl","undefined","className","destroyed","iconUrl","key","position","Component","YearsResponse","years","CitiesResponse","OverviewResponse","people","list","DataService","base","fetch","resp","json","level","swlat","swlng","nelat","nelng","method","headers","body","JSON","stringify","App","dataService","timeout","fetchCities","clearTimeout","setTimeout","getCitiesLevel","lvl","getCitiesOverview","overview","myfunc","Number","$","innerText","ionRangeSlider","skin","from","step","grid","grid_num","grid_snap","s","length","id","style","height","elevation","name","population","round","padding","c","filter","_","src","Gorod","width","window","innerWidth","type","React","Boolean","location","hostname","match","ReactDOM","render","document","getElementById","imagePath","navigator","serviceWorker","ready","then","registration","unregister"],"mappings":"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","file":"static/js/main.0d58eb21.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/Gorod.bcf9720b.svg\";","import React, { Component } from 'react'\r\nimport { Map, TileLayer, Marker, Popup } from 'react-leaflet'\r\nimport Leaflet from 'leaflet';\r\nimport { City } from '../interfaces/IDataService';\r\n\r\ninterface IProps {\r\n  onClick: (city: City) => void;\r\n  needMapUpdate: (swlat: number, swlng: number, nelat: number, nelng: number) => void\r\n  lvl: number;\r\n  cities: City[],\r\n}\r\n\r\nclass State {\r\n  zoom: number = 5;\r\n}\r\n\r\nexport class LeafletMap extends Component<IProps, State> {\r\n  state: State = {\r\n    zoom: 4,\r\n  }\r\n\r\n  async componentDidMount() {\r\n    this.updateCities();\r\n  }\r\n\r\n  map: any;\r\n\r\n  render() {\r\n    const minZoom = 10;\r\n    const zoom = Math.max(minZoom, this.state.zoom);\r\n    // const position: [number, number] = [this.state.lat, this.state.lng]\r\n    return (\r\n      <Map onClick={this.handleClick} ref={(ref) => { this.map = ref; }} center={[51.505,  -0.09]} zoom={7} onViewportChange={this.handleViewportChange}>\r\n        <TileLayer\r\n          attribution='&amp;copy <a href=\"http://osm.org/copyright\">OpenStreetMap</a> contributors'\r\n          url=\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\"\r\n        />\r\n        {\r\n          this.props.cities.map((city, i) => \r\n          <Marker icon={new Leaflet.Icon.Default({shadowUrl: undefined, className: city.destroyed ? 'bad' : 'good', iconUrl: undefined})} key={i} position={[city.lat, city.lng]}></Marker>)\r\n        }\r\n      </Map>\r\n    )\r\n  }\r\n\r\n  private handleClick = (e: any) => {\r\n    let n = null;\r\n    let min = 0.1;\r\n    console.log(e);\r\n    const latlng = e.latlng;\r\n    const lat = latlng.lat;\r\n    const lng = latlng.lng;\r\n\r\n    for (const city of this.props.cities) {\r\n      const dx = city.lat - lat;\r\n      const dy = city.lng - lng;\r\n\r\n      const v = dx * dx + dy*dy;\r\n      if (v < min) {\r\n        n = city;\r\n        min = v;\r\n      }\r\n\r\n    }\r\n\r\n    console.log(min);\r\n    if (n != null) {\r\n      this.props.onClick(n);\r\n    }\r\n  }\r\n\r\n  private handleViewportChange = (viewport: any) => {\r\n    this.setState({zoom: Math.max(10, viewport.zoom)})\r\n    this.updateCities();\r\n  }\r\n\r\n  private updateCities = async () => {\r\n    try {\r\n      const bounds = this.map.leafletElement.getBounds();\r\n      this.props.needMapUpdate(bounds._southWest.lat, bounds._southWest.lng , bounds._northEast.lat, bounds._northEast.lng)\r\n    } catch(error) {\r\n      console.error(error);\r\n    }\r\n  }\r\n}\r\n","export class Year {\r\n    level: number = 0;\r\n    year: number = 1880;\r\n}\r\n\r\nexport class YearsResponse {\r\n    years: Year[] = [];\r\n}\r\n\r\nexport class City {\r\n    id: number = 0;\r\n    name: string = '';\r\n    country: string = '';\r\n    elevation: number = 0;\r\n    population: number = 0;\r\n    iso3: number = 0;\r\n    lng: number = 0;\r\n    lat: number = 0;\r\n    destroyed: boolean = false;\r\n}\r\n\r\nexport class CitiesResponse{\r\n    cities: City[] = [];\r\n}\r\n\r\nexport class OverviewResponse {\r\n    cities: number = 0;\r\n    people: number = 0;\r\n    list: {cities: City[] } = { cities: []};\r\n}\r\n\r\nexport interface IDataService {\r\n    getYears(): Promise<YearsResponse>;\r\n    getCitiesLevel(level: number, swlat: number, swlng: number, nelat: number, nelng: number): Promise<CitiesResponse> \r\n    getCitiesOverview(level: number): Promise<OverviewResponse>\r\n}","import {YearsResponse, IDataService, CitiesResponse, OverviewResponse} from '../interfaces/IDataService'\r\n\r\nexport class DataService implements IDataService{\r\n    base: string = 'https://shulaikin.tech:5000';\r\n\r\n    public async getYears(): Promise<YearsResponse> {\r\n        try {\r\n            var resp = await fetch(`${this.base}/years`);\r\n            var json = await resp.json();\r\n            return json as YearsResponse;\r\n        } catch (error){\r\n            console.error(error);\r\n            return new YearsResponse();\r\n        }\r\n    }\r\n\r\n    public async getCitiesLevel(level: number, swlat: number, swlng: number, nelat: number, nelng: number): Promise<CitiesResponse> {\r\n        try {\r\n            var resp = await fetch(`${this.base}/cities_below_level`, {method: 'POST', headers: {\r\n                'Content-Type': 'application/json'\r\n                // 'Content-Type': 'application/x-www-form-urlencoded',\r\n              },body : JSON.stringify({\r\n                level, swlat, swlng, nelat, nelng\r\n            })});\r\n            var json = await resp.json();\r\n            return json as CitiesResponse;\r\n        } catch (error){\r\n            console.error(error);\r\n            return new CitiesResponse();\r\n        }\r\n    }\r\n\r\n    public async getCitiesOverview(level: number): Promise<OverviewResponse> {\r\n        try {\r\n            var resp = await fetch(`${this.base}/total_cities_below_level`, {method: 'POST', headers: {\r\n                'Content-Type': 'application/json'\r\n                // 'Content-Type': 'application/x-www-form-urlencoded',\r\n              },body : JSON.stringify({\r\n                level\r\n            })});\r\n            var json = await resp.json();\r\n            return json as OverviewResponse;\r\n        } catch (error){\r\n            console.error(error);\r\n            return new OverviewResponse();\r\n        }\r\n    }\r\n}","import React from 'react';\r\nimport './App.css';\r\nimport { LeafletMap } from './pages/Map'\r\nimport { DataService } from './services/DataService';\r\nimport Gorod from \"./static/Gorod.svg\"\r\nimport { City, IDataService, OverviewResponse } from './interfaces/IDataService';\r\n\r\ninterface IState {\r\n  lvl: number;\r\n  city: City | null;\r\n  cities: City[];\r\n  swlat: number;\r\n  swlng: number;\r\n  nelat: number;\r\n  nelng: number;\r\n  overview: OverviewResponse;\r\n}\r\n\r\nclass App extends React.Component<{}, IState> {\r\n  dataService: IDataService | null = null;\r\n  timeout : NodeJS.Timeout | null = null;\r\n\r\n  constructor(props: any) {\r\n    super(props)\r\n    this.state = ({\r\n      lvl: 0,\r\n      city: null,\r\n      cities: [],\r\n      swlat: 0,\r\n      swlng: 0,\r\n      nelat: 0,\r\n      nelng: 0,\r\n      overview: new OverviewResponse()\r\n    })\r\n\r\n    this.dataService = new DataService();\r\n  }\r\n\r\n  private handleClick = (city: City) => {\r\n    this.setState(() => ({city}))\r\n  }\r\n\r\n  componentDidMount() {\r\n    // const dataservice = new DataService();\r\n    ($(\".js-range-slider-2\") as any).ionRangeSlider({\r\n      skin: \"big\",\r\n      min: 0,\r\n      max: 100,\r\n      from: 0,\r\n      step: 1,            // default 1 (set step)\r\n      grid: true,         // default false (enable grid)\r\n      grid_num: 10,        // default 4 (set number of grid cells)\r\n      grid_snap: false    // default false (snap grid to step)\r\n    })\r\n  }\r\n\r\n  componentDidUpdate() {\r\n\r\n    ($(\".js-range-slider-2\") as any).ionRangeSlider({\r\n      skin: \"big\",\r\n      min: 0,\r\n      max: 100,\r\n      from: 0,\r\n      step: 1,            // default 1 (set step)\r\n      grid: true,         // default false (enable grid)\r\n      grid_num: 10,        // default 4 (set number of grid cells)\r\n      grid_snap: false    // default false (snap grid to step)\r\n    })\r\n  }\r\n\r\n  render() {\r\n\r\n    let s = null;\r\n    let city = this.state.city || ( this.state.cities && this.state.cities.length > 0 && this.state.cities[0]);\r\n\r\n    if (city) { \r\n      s = <div className=\"smallStakan\">\r\n        <label className=\"lab\">\r\n          <div className=\"fil\" id=\"fill\" style={{ height: `${Math.min(100 - (Math.max(city.elevation, 0) - this.state.lvl) / Math.max(city.elevation, 1) * 100, 100)}%` }}>\r\n          </div>\r\n        </label>\r\n        <h1>{city.name}</h1>\r\n        <h4>City population: </h4>\r\n        <h5>{city.population == 0 ? '<no-info>' : `${Math.round(city.population)} people`}</h5>\r\n        <h4>City elevation: {city.elevation}m</h4>\r\n        <h4>Cities affected: {this.state.overview.cities}</h4>\r\n        <h4>People affected</h4>\r\n        <h5>{this.state.overview.people == 0 ? '<no-info>' : `${Math.round(this.state.overview.people)} people`}</h5>\r\n        <h4>Major cities affected:</h4>\r\n        <ul style={{padding: 0}}> \r\n          {this.state.overview.list.cities.map(c => <li>{c.name} - {c.population} people</li>).filter((_, i) => i < 5)}\r\n        </ul>\r\n        <h2>Sea level: {this.state.lvl} m</h2>\r\n        <img src={Gorod} className=\"gorod\"></img>\r\n      </div>\r\n    }\r\n    \r\n    return (\r\n      <div className=\"cont\">\r\n        <div className=\"stakan\">\r\n          {s}\r\n        </div>\r\n        <div className=\"map\">\r\n          <LeafletMap onClick={this.handleClick} lvl={this.state.lvl} needMapUpdate={this.fetchCities} cities={this.state.cities}/>\r\n        </div>\r\n        <div style={{width: `${window.innerWidth || 500}px`}}className=\"polzynok\" onClick={this.myfunc}>\r\n          <input type=\"number\" className=\"js-range-slider-2\" name=\"my_range\"/>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  fetchCities = async (swlat: number, swlng: number, nelat: number, nelng: number) => {\r\n    if (this.timeout) {\r\n      clearTimeout(this.timeout);\r\n    }\r\n\r\n    this.timeout = setTimeout(async () => {\r\n      const { cities } = await this.dataService!.getCitiesLevel(this.state.lvl, swlat, swlng , nelat, nelng);\r\n      const overview = await this.dataService!.getCitiesOverview(this.state.lvl);\r\n      this.setState(() => ({ cities, swlat, swlng, nelat, nelng, overview}));\r\n    }, 300);\r\n    \r\n  }\r\n\r\n  myfunc = () => {\r\n    const a = Number($(\".irs-single\")[0].innerText)\r\n    this.setState(() => ({\r\n      lvl: a\r\n    }), () => {\r\n      const { swlat, swlng, nelat, nelng} = this.state\r\n      this.fetchCities(swlat, swlng, nelat, nelng)\r\n    })\r\n  }\r\n}\r\n\r\nexport default App;\r\n","// This optional code is used to register a service worker.\r\n// register() is not called by default.\r\n\r\n// This lets the app load faster on subsequent visits in production, and gives\r\n// it offline capabilities. However, it also means that developers (and users)\r\n// will only see deployed updates on subsequent visits to a page, after all the\r\n// existing tabs open on the page have been closed, since previously cached\r\n// resources are updated in the background.\r\n\r\n// To learn more about the benefits of this model and instructions on how to\r\n// opt-in, read https://bit.ly/CRA-PWA\r\n\r\nconst isLocalhost = Boolean(\r\n  window.location.hostname === 'localhost' ||\r\n    // [::1] is the IPv6 localhost address.\r\n    window.location.hostname === '[::1]' ||\r\n    // 127.0.0.1/8 is considered localhost for IPv4.\r\n    window.location.hostname.match(\r\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\r\n    )\r\n);\r\n\r\ntype Config = {\r\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\r\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\r\n};\r\n\r\nexport function register(config?: Config) {\r\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\r\n    // The URL constructor is available in all browsers that support SW.\r\n    const publicUrl = new URL(\r\n      (process as { env: { [key: string]: string } }).env.PUBLIC_URL,\r\n      window.location.href\r\n    );\r\n    if (publicUrl.origin !== window.location.origin) {\r\n      // Our service worker won't work if PUBLIC_URL is on a different origin\r\n      // from what our page is served on. This might happen if a CDN is used to\r\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\r\n      return;\r\n    }\r\n\r\n    window.addEventListener('load', () => {\r\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\r\n\r\n      if (isLocalhost) {\r\n        // This is running on localhost. Let's check if a service worker still exists or not.\r\n        checkValidServiceWorker(swUrl, config);\r\n\r\n        // Add some additional logging to localhost, pointing developers to the\r\n        // service worker/PWA documentation.\r\n        navigator.serviceWorker.ready.then(() => {\r\n          console.log(\r\n            'This web app is being served cache-first by a service ' +\r\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\r\n          );\r\n        });\r\n      } else {\r\n        // Is not localhost. Just register service worker\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    });\r\n  }\r\n}\r\n\r\nfunction registerValidSW(swUrl: string, config?: Config) {\r\n  navigator.serviceWorker\r\n    .register(swUrl)\r\n    .then(registration => {\r\n      registration.onupdatefound = () => {\r\n        const installingWorker = registration.installing;\r\n        if (installingWorker == null) {\r\n          return;\r\n        }\r\n        installingWorker.onstatechange = () => {\r\n          if (installingWorker.state === 'installed') {\r\n            if (navigator.serviceWorker.controller) {\r\n              // At this point, the updated precached content has been fetched,\r\n              // but the previous service worker will still serve the older\r\n              // content until all client tabs are closed.\r\n              console.log(\r\n                'New content is available and will be used when all ' +\r\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\r\n              );\r\n\r\n              // Execute callback\r\n              if (config && config.onUpdate) {\r\n                config.onUpdate(registration);\r\n              }\r\n            } else {\r\n              // At this point, everything has been precached.\r\n              // It's the perfect time to display a\r\n              // \"Content is cached for offline use.\" message.\r\n              console.log('Content is cached for offline use.');\r\n\r\n              // Execute callback\r\n              if (config && config.onSuccess) {\r\n                config.onSuccess(registration);\r\n              }\r\n            }\r\n          }\r\n        };\r\n      };\r\n    })\r\n    .catch(error => {\r\n      console.error('Error during service worker registration:', error);\r\n    });\r\n}\r\n\r\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\r\n  // Check if the service worker can be found. If it can't reload the page.\r\n  fetch(swUrl)\r\n    .then(response => {\r\n      // Ensure service worker exists, and that we really are getting a JS file.\r\n      const contentType = response.headers.get('content-type');\r\n      if (\r\n        response.status === 404 ||\r\n        (contentType != null && contentType.indexOf('javascript') === -1)\r\n      ) {\r\n        // No service worker found. Probably a different app. Reload the page.\r\n        navigator.serviceWorker.ready.then(registration => {\r\n          registration.unregister().then(() => {\r\n            window.location.reload();\r\n          });\r\n        });\r\n      } else {\r\n        // Service worker found. Proceed as normal.\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    })\r\n    .catch(() => {\r\n      console.log(\r\n        'No internet connection found. App is running in offline mode.'\r\n      );\r\n    });\r\n}\r\n\r\nexport function unregister() {\r\n  if ('serviceWorker' in navigator) {\r\n    navigator.serviceWorker.ready.then(registration => {\r\n      registration.unregister();\r\n    });\r\n  }\r\n}\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport './index.css';\r\nimport App from './App';\r\nimport * as serviceWorker from './serviceWorker';\r\nimport Leaflet from 'leaflet'\r\nReactDOM.render(<App />, document.getElementById('root'));\r\nLeaflet.Icon.Default.imagePath =\r\n  '//cdnjs.cloudflare.com/ajax/libs/leaflet/1.3.4/images/'\r\n// If you want your app to work offline and load faster, you can change\r\n// unregister() to register() below. Note this comes with some pitfalls.\r\n// Learn more about service workers: https://bit.ly/CRA-PWA\r\nserviceWorker.unregister();\r\n"],"sourceRoot":""}